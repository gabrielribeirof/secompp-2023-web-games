<html>
  <head>
    <meta charset="utf-8" />
    <title>Meu Primeiro Jogo Multiplayer</title>
    <link rel="stylesheet" type="text/css" href="style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Josefin+Sans&family=Work+Sans:wght@300&display=swap"
      rel="stylesheet"
    />
    <script src="/socket.io/socket.io.js"></script>
  </head>
  <body>
    <div id="container">
      <h1>Jogo da velha Multiplayer</h1>

      <div id="jogo">
        <div id="casa1">.</div>
        <div id="casa2">.</div>
        <div id="casa3">.</div>
        <div id="casa4">.</div>
        <div id="casa5">.</div>
        <div id="casa6">.</div>
        <div id="casa7">.</div>
        <div id="casa8">.</div>
        <div id="casa9">.</div>
      </div>
    </div>

    <script type="module">
      import { createGame } from './game.js'

      const game = createGame()
      const socket = io()

      socket.on('connect', () => {
        console.log(`>>> Player connected with id ${socket.id}`)

        socket.emit('add-turn', {
          playerId: socket.id,
          index: 1
        })
      })

      socket.on('setup', command => {
        game.setState(command.state)
      })

      socket.on('add-player', command => {
        console.log(`Receiving ${command.type} -> ${command.playerId}`)

        game.addPlayer(command)
      })

      socket.on('remove-player', command => {
        console.log(`Receiving ${command.type} -> ${command.playerId}`)
        
        game.removePlayer(command)
      })

      socket.on('add-turn', command => {
        console.log(`Receiving ${command.type} -> ${command.playerId}`)
      })
    </script>
  </body>
</html>
